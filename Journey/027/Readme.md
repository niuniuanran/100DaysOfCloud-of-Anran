# Architect Professional Prep - Day 14

## An interface endpoint supports TCP traffic only.
To ensure that your service connectivity does not traverse the Internet:

> Create a VPC Endpoint Service that accepts TCP traffic, host it behind a Network Load Balancer, and make the service available over DX.

## Resolving DNS queries between VPCs and your network

- When you create a VPC using Amazon VPC, **Route 53 Resolver automatically answers DNS queries for local VPC domain names for EC2 instances (ec2-192-0-2-44.compute-1.amazonaws.com) and records in private hosted zones (acme.example.com)**. 
- For all other domain names, Route 53 Resolver performs recursive lookups against **public name servers**.
- You also can integrate DNS resolution between **Route 53 Resolver** and **DNS resolvers on your network** by *configuring forwarding rules*. Your network can include any network that is reachable from your VPC, such as the following:
    - The VPC itself
    - Another peered VPC
    - An on-premises network that is connected to AWS with AWS Direct Connect, a VPN, or a network address translation (NAT) gateway
- Before you start to forward queries, you create Resolver **inbound and/or outbound endpoints** in the connected VPC. These endpoints provide a path for inbound or outbound queries.

### Inbound endpoint
- DNS resolvers on your network can forward DNS queries to Route 53 Resolver via this endpoint.
- This allows your DNS resolvers to easily resolve domain names for AWS resources such as EC2 instances or records in a Route 53 private hosted zone. 

### Outbound endpoint
- Route 53 Resolver **conditionally forwards queries to resolvers on your network** via this endpoint
- To forward selected queries, you create Resolver rules that specify the domain names for the DNS queries that you want to forward (such as example.com), and the *IP addresses* of the DNS resolvers on your network that you want to forward the queries to. 
- If a query matches multiple rules (example.com, acme.example.com), Resolver chooses the rule with the *most specific match* (acme.example.com).

## Canary deployment v.s. Blue-Green
- Canary deployment is like blue-green, except it's more risk-averse. 
- Instead of switching from blue to green in one step, you use a phased approach. 
- A common way to implement Canary is regular Blue/Green with the addition of smart routing of specific users to the new version. 

## WAF Web ACL
- A web access control list (web ACL) gives you fine-grained control over the web requests that your protected resource responds to. 
- You can protect:
    1. Amazon CloudFront, 
    2. Amazon API Gateway, 
    3. Application Load Balancer, and 
    4. AWS AppSync resources.
- You can use criteria like the following to allow or block requests:
    1. IP address origin of the request
    2. Country of origin of the request
    3. String match or regular expression (regex) match in a part of the request
    4. Size of a particular part of the request
    5. Detection of malicious SQL code or scripting

## Migrate Data using AWS Storage Gateway - File Gateway
Use cases for File Gateway include: 
- Migrating on-premises file data to Amazon S3, while maintaining fast local access to recently accessed data, 
- Backing up on-premises file data as objects in Amazon S3 (including Microsoft SQL Server and Oracle databases and logs), with the ability to use S3 capabilities such as lifecycle management and cross region replication, and, 
- Hybrid cloud workflows using data generated by on-premises applications for processing by AWS services such as machine learning, big data analytics or serverless functions.

## Systems Manager Runbooks(Automation documents)
- Automation documents are now referred to as runbooks. 
- A Systems Manager Automation runbook defines the actions that Systems Manager performs on your managed instances and other AWS resources when an automation runs. 
- A runbook contains one or more steps that run in sequential order.

## Amazon Inspector
CVE(common vulnerability )

## AWS::SecretsManager::RotationSchedule
- The `AWS::SecretsManager::RotationSchedule` resource configures rotation for a secret. 
- You must already configure the secret with the details of the database or service. If you define both the secret and the database or service in an AWS CloudFormation template, then define the `AWS::SecretsManager::SecretTargetAttachment` resource to populate the secret with the connection details of the database or service before you attempt to configure rotation.
- When you configure rotation for a secret, AWS CloudFormation automatically rotates the secret one time. Be sure you configure all your clients to retrieve the secret using Secrets Manager before configuring rotation to prevent breaking them.

## User cases for ElastiCache
Using Amazon ElastiCache, you can:
- Improve load and response times to user actions and queries
- Reduce the cost associated with scaling web applications.

## S3 Replication Time Control (S3 RTC) 
- S3 Replication Time Control (S3 RTC) helps you meet compliance or business requirements for data replication and provides visibility into Amazon S3 replication times. 
- S3 RTC replicates most objects that you upload to Amazon S3 in seconds, and **99.99 percent of those objects within 15 minutes**.

## Replicating objects created SSE-KMS CMK
- By default, Amazon S3 doesn't replicate objects that are stored at rest using server-side encryption with customer master keys (CMKs) stored in AWS KMS. 
- This section explains additional configuration that you add to direct Amazon S3 to replicate these objects.

### [Specifying additional information in the replication configuration](https://docs.aws.amazon.com/AmazonS3/latest/dev/replication-config-for-kms-objects.html)
- In the replication configuration, you do the following:
1. In the `Destination` configuration, add the **symmetric** customer managed AWS KMS CMK that you want Amazon S3 to use to encrypt object replicas.
2. Explicitly opt in by enabling replication of objects encrypted using AWS KMS CMKs by adding the `SourceSelectionCriteria` element.

### Granting additional permissions for the IAM role
To replicate objects that are encrypted at rest under AWS Key Management Service (AWS KMS), grant the following additional permissions to the IAM role you specify in the replication configuration. You grant these permissions by updating the permission policy associated with the IAM role. 
- We recommend that you use the `s3:GetObjectVersionForReplication` action instead of the `s3:GetObjectVersion` action because it provides Amazon S3 with only the minimum permissions necessary for replication. 
- `kms:Decrypt` and `kms:Encrypt` AWS KMS actions.

## Permissions boundaries for IAM entities
An entity's permissions boundary allows it to perform only the actions that are allowed by both its identity-based policies and its permissions boundaries.

<img src="https://docs.aws.amazon.com/IAM/latest/UserGuide/images/EffectivePermissions-rbp-boundary-id.png" alt="" width="400px"/>

<img src="https://docs.aws.amazon.com/IAM/latest/UserGuide/images/EffectivePermissions-scp-boundary-id.png" alt="" width="400px"/>

## Tools to plan a migration
### AWS Application Discovery Service
AWS Application Discovery Service helps enterprise customers plan migration projects by gathering information about their on-premises data centers.

### AWS Cloud Adoption Readiness Tool (CART)
The AWS Cloud Adoption Readiness Tool (CART) helps organizations of all sizes develop efficient and effective plans for cloud adoption and enterprise cloud migrations.

### AWS Migration Hub
AWS Migration Hub helps plan your migrations by allowing you to group related servers and resources that should be migrated together. 

## [Enable IAM authentication for your API](https://aws.amazon.com/premiumsupport/knowledge-center/iam-authentication-api-gateway/)
- For each API Gateway method, set the `authorization` to `AWS_IAM`.
- Give the IAM user or role `execute-api:Invoke` permission on the API resource.
- Enable to API caller to sign requests with AWS Signature when accessing the endpoint.

## Aurora Serverless resides in a private subnet of a VPC
- Aurora Serverless resides in the private subnet of Amazon Virtual Private Cloud (Amazon VPC). 
- You can't give an Aurora Serverless DB cluster a public IP address
- You can only access it from within a VPC based on the Amazon VPC service.
- You can use any service, such as Amazon Elastic Compute Cloud (Amazon EC2), Lambda, Amazon Elastic Container Service (Amazon ECS), and more, if they reside within the same VPC.

## Use Amazon FSx for Lustre for workloads where speed matters
- High-performance file system
- Use Amazon FSx for Lustre for workloads where speed matters, such as machine learning, high performance computing (HPC), video processing, financial modeling, genome sequencing, and electronic design automation (EDA).

## CI/CD for a tool running within docker container
- Configure an Amazon ECR repository for the tool. 
- Configure an AWS CodeCommit repository containing code for the tool being deployed to the container image in Amazon ECR.
- Configure an AWS CodeBuild project that pulls the latest tool container image from Amazon ECR, updates the container with code from the source AWS CodeCommit repository, and pushes the updated container image from Amazon ECR.
- Configure an AWS CodePipeline pipeline that sources the tool code from the AWS CodeCommit repository and initiates an AWS CodeBuild build.

### Amazon ECR
Amazon Elastic Container Registry (ECR) is a fully managed container registry that makes it easy to store, manage, share, and deploy your **container images and artifacts** anywhere. 

## AWS CDK
The AWS CDK lets you easily define applications in the AWS Cloud using your programming language of choice.

> Define the AWS resources using TypeScript or Python. Use the AWS Cloud Development Kit (AWS CDK) to create CloudFormation templates from the developers' code, and use the AWS CDK to create CloudFormation stacks. Incorporate the AWS CDK as a CodeBuild job in CodePipeline.

## Snowball transfer speed
- The data transfer rate using the file interface is typically between 25 MB/s and 40 MB/s. If you need to transfer data faster than this, use the **Amazon S3 Adapter for Snowball**, which has a data transfer rate typically between 250 MB/s and 400 MB/s. 
- Transfer smaller files in batches, set `snowball-auto-extract=true`
- Reduce local network use – Your AWS Snowball Edge device communicates across your local network. 

## Organisation APIs
### MoveAccount
- Moves an account from its current source parent root or organizational unit (OU) to the specified destination parent root or OU.
- This operation can be called only from the organization's management account.

### RemoveAccountFromOrganization
- Removes the specified account from the organization.
- This operation can be called only from the organization's management account. Member accounts can remove themselves with LeaveOrganization instead.

### InviteAccountToOrganization
Sends an invitation to another account to join your organization as a member account. AWS Organizations sends email on your behalf to the email address that is associated with the other account's owner. The invitation is implemented as a Handshake whose details are in the response.

## Organization Tag Policy
Tag policies are a type of policy that can help you standardize tags across resources in your organization's accounts. In a tag policy, you specify tagging rules applicable to resources when they are tagged.

## CloudEndure Migration
- Has an agent
- You can use CloudEndure Migration to quickly lift-and-shift physical, virtual, or cloud servers without compatibility issues, performance impact, or long cutover windows. 
- CloudEndure Migration continuously replicates your source servers to your AWS account. 
- Then, when you’re ready to migrate, it automatically converts and launches your servers on AWS so you can quickly benefit from the cost savings, productivity, resilience, and agility of the AWS Cloud.

## AWS Server Migration Service
AWS Server Migration Service (SMS) is an **agentless** service.

## Aurora Serverless - Aurora Data API
- By using the Data API for Aurora Serverless, you can work with a web-services interface to your Aurora Serverless DB cluster. 
- Users can invoke Data API operations only if they are authorized to do so. You can give a user permission to use the Data API by attaching an AWS Identity and Access Management (IAM) policy that defines their privileges. You can also attach the policy to a role if you're using IAM roles. An AWS managed policy, AmazonRDSDataFullAccess, includes permissions for the RDS Data API.








